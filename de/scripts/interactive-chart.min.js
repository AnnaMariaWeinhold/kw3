var x=Object.defineProperty,E=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var g=(t,e,n)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))B.call(e,n)&&g(t,n,e[n]);if(v)for(var n of v(e))w.call(e,n)&&g(t,n,e[n]);return t},m=(t,e)=>E(t,b(e));function sliceDataFrom(t,e){return t.slice(t.findIndex(n=>n[0].endsWith(e)))}function calculateStrategy(t,e=1e4,n="1998"){basis=sliceDataFrom(t,n);const o=[];let a=e;for(const[i,l,y]of basis)if(y==="X"){const s=a*(1+l/100);o.push(s),a=s}else o.push(a);return o}function calculateSP(t,e=1e4,n="1998"){const o=sliceDataFrom(t,n),a=[];let i=e;for(const[l,y]of o){const s=i*(1+y/100);a.push(s),i=s}return a}function debounce(t=500,e){let n;return o=>{n&&clearTimeout(n),n=setTimeout(()=>e(o),t)}}window.addEventListener("DOMContentLoaded",async function(){const t=echarts.init(document.getElementById("interactive-chart")),e=await fetch("/data/sp-basis.json").then(d=>d.json()),n=e.shift(),o=e.map(d=>d[0]),a="S&P Strategie",i={title:{text:"S&P Strategy vs Buy-and-Hold"},xAxis:{type:"category",data:o},yAxis:{type:"value"},series:[{name:a,type:"line",data:calculateStrategy(e)},{name:"Buy and Hold",type:"line",data:calculateSP(e)}]},l=document.getElementById("chart-dialog"),y=document.querySelector("#chart-dialog button"),s=document.getElementById("start-money");s.addEventListener("change",d=>{const r=Number(d.target.value),f=m(p({},i),{xAxis:{type:"category",data:sliceDataFrom(e,c.value).map(u=>u[0])},series:[{name:a,type:"line",data:calculateStrategy(e,r||void 0,c.value||void 0)},{name:"Buy and Hold",type:"line",data:calculateSP(e,r||void 0,c.value||void 0)}]});t.setOption(f)}),document.getElementById("year-picker").addEventListener("click",function(d){c.value=d.target.dataset.value,c.dispatchEvent(new Event("change"))});const c=document.getElementById("start-year");c.addEventListener("change",debounce(600,d=>{c.blur();const r=d.target.value;if(e.findIndex(u=>u[0].endsWith(r))>-1){const u=m(p({},i),{xAxis:{type:"category",data:sliceDataFrom(e,r).map(h=>h[0])},series:[{name:a,type:"line",data:calculateStrategy(e,Number(s.value)||void 0,r)},{name:"Buy and Hold",type:"line",data:calculateSP(e,Number(s.value)||void 0,r)}]});t.setOption(u)}else l.style.display="block",y.addEventListener("click",u=>{l.style.display="none"})})),t.setOption(i)});
